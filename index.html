<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Hexo, NexT">








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0">






<meta name="description" content="喜阅文，常笃学，善运动，乐言谈。擅长前端，偶尔研究用户体验，正致力于全栈开发。">
<meta name="keywords" content="前端,js,javascript,AngularJS,MEAN,Vue,html5,程序媛,程序猿,编程,IT网站,开源,用户体验,Developer,Programmer,Coder,Geek,html,css,css3">
<meta property="og:type" content="website">
<meta property="og:title" content="Avril的博客">
<meta property="og:url" content="http://www.avrils.cc/index.html">
<meta property="og:site_name" content="Avril的博客">
<meta property="og:description" content="喜阅文，常笃学，善运动，乐言谈。擅长前端，偶尔研究用户体验，正致力于全栈开发。">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Avril的博客">
<meta name="twitter:description" content="喜阅文，常笃学，善运动，乐言谈。擅长前端，偶尔研究用户体验，正致力于全栈开发。">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.avrils.cc/">





  <title> Avril的博客 </title>
</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Avril的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">伪文艺程序媛，动静皆宜</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope="" itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.avrils.cc/10/11/simple-release/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Avril Li">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/logo.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Avril的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/10/11/simple-release/" itemprop="url">
                  基于JavaScript的简单DevOps
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-10-11T19:03:49+08:00">
                2019-10-11
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/DevOps/" itemprop="url" rel="index">
                    <span itemprop="name">DevOps</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>平时的工作中，项目的持续集成和部署会有运维负责，随着DevOps的提倡，开发学习部署是大势所趋。得益于工作中小组的发展，所负责的项目都是通过公司运维搭建的gitlab和Rancher集成实现CI/CD，加快了上线速度。但是作为个人实践与学习，还是从基础开始吧，在此做个笔记。<br>相关代码：<a href="https://github.com/LinLzis/simple-devops" target="_blank" rel="noopener">https://github.com/LinLzis/simple-devops</a></p>
<h2 id="1-持续集成和布署"><a href="#1-持续集成和布署" class="headerlink" title="1.持续集成和布署"></a>1.持续集成和布署</h2><ul>
<li>技术栈 前台Vue.js,后台Node.js</li>
<li>服务器 前台Nginx,后台Node.js</li>
</ul>
<p>如图：开发人员提交代码到Git服务器后，触发Webhook通知CI  Server到Git仓库pull最新的代码进行自动化构建、测试，然后CD Server自动让不同环境的Docker到构建好的镜像服务器中拉取对应的镜像进行部署。</p>
<p><img src="/images/webhookscicd2.png" alt="webhookscicd2"></p>
<h2 id="2-编写后端服务"><a href="#2-编写后端服务" class="headerlink" title="2.编写后端服务"></a>2.编写后端服务</h2><h3 id="2-1-package-json"><a href="#2-1-package-json" class="headerlink" title="2.1 package.json"></a>2.1 package.json</h3><p>/usr/projects/vue-back/package.json<br><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  "name": "vue-back",</span><br><span class="line">  "version": "0.0.0",</span><br><span class="line">  "private": true,</span><br><span class="line">  "scripts": &#123;</span><br><span class="line"><span class="addition">+    "start": "node ./server.js "</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="2-2-server-js"><a href="#2-2-server-js" class="headerlink" title="2.2 server.js"></a>2.2 server.js</h3><p>/usr/projects/vue-back/server.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">let</span> users = [</span><br><span class="line">    &#123;<span class="attr">id</span>:<span class="number">100</span>,<span class="attr">name</span>:<span class="string">'user1'</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">id</span>:<span class="number">101</span>,<span class="attr">name</span>:<span class="string">'user2'</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">id</span>:<span class="number">1002</span>,<span class="attr">name</span>:<span class="string">'user3'</span>&#125;</span><br><span class="line">]</span><br><span class="line"><span class="keyword">let</span> server = http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">  res.setHeader(<span class="string">'Access-Control-Allow-Origin'</span>,<span class="string">'*'</span>);</span><br><span class="line">  <span class="keyword">if</span>(req.url === <span class="string">'/api/users'</span>)&#123;</span><br><span class="line">      res.json(users);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      res.send(<span class="string">'API Not Found'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">server.listen(<span class="number">3000</span>,()=&gt;&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Server Run Port: 3000'</span>)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h3 id="2-3-gitignore"><a href="#2-3-gitignore" class="headerlink" title="2.3 .gitignore"></a>2.3 .gitignore</h3><p>/usr/projects/vue-back/.gitignore<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">node_modules</span><br><span class="line">lib</span><br><span class="line">package-lock.json</span><br></pre></td></tr></table></figure></p>
<h2 id="3-前端项目"><a href="#3-前端项目" class="headerlink" title="3.前端项目"></a>3.前端项目</h2><h3 id="3-1-安装脚手架生成项目"><a href="#3-1-安装脚手架生成项目" class="headerlink" title="3.1 安装脚手架生成项目"></a>3.1 安装脚手架生成项目</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cnpm i @vue/cli -g</span><br><span class="line">vue create vue-front</span><br><span class="line">cd vue-front</span><br><span class="line">cnpm i axios -S</span><br></pre></td></tr></table></figure>
<h3 id="3-2-App-vue"><a href="#3-2-App-vue" class="headerlink" title="3.2 App.vue"></a>3.2 App.vue</h3><p>/usr/projects/vue-front/src/App.vue<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"(user) in users"</span> <span class="attr">:key</span>=<span class="string">"user.id"</span>&gt;</span></span><br><span class="line">      &#123;&#123;user.id&#125;&#125;:&#123;&#123;user.name&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">'app'</span>,</span></span><br><span class="line"><span class="undefined">  data()&#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="undefined">      users:[]</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;,</span></span><br><span class="line"><span class="undefined">  mounted()&#123;</span></span><br><span class="line"><span class="javascript">    axios.get(<span class="string">'http://localhost:3000/api/users'</span>).then(<span class="function"><span class="params">response</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">this</span>.users = response.data;</span></span><br><span class="line"><span class="undefined">    &#125;);</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="4-CI-CD服务器"><a href="#4-CI-CD服务器" class="headerlink" title="4. CI/CD服务器"></a>4. CI/CD服务器</h2><ul>
<li><a href="https://developer.github.com/webhooks/" target="_blank" rel="noopener">webhooks文档</a></li>
<li><a href="https://developer.github.com/v3/activity/events/types/#pushevent" target="_blank" rel="noopener">pushevent</a></li>
</ul>
<p><img src="/images/githubhook.png" alt="githubhook"></p>
<h3 id="4-1-生成项目"><a href="#4-1-生成项目" class="headerlink" title="4.1 生成项目"></a>4.1 生成项目</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir vue-webhook</span><br><span class="line">cd vue-webhook</span><br><span class="line">cnpm init -y</span><br><span class="line">cnpm i nodemailer -S</span><br></pre></td></tr></table></figure>
<h3 id="4-2-webhook-js"><a href="#4-2-webhook-js" class="headerlink" title="4.2 webhook.js"></a>4.2 webhook.js</h3><p>/usr/projects/vue-webhook/webhook.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">let</span> crypto = <span class="built_in">require</span>(<span class="string">'crypto'</span>);</span><br><span class="line"><span class="keyword">let</span> &#123;spawn&#125; = <span class="built_in">require</span>(<span class="string">'child_process'</span>);</span><br><span class="line"><span class="keyword">let</span> SECRET= <span class="string">'123456'</span>;</span><br><span class="line"><span class="keyword">let</span> sendMail = <span class="built_in">require</span>(<span class="string">'./sendMail'</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sign</span>(<span class="params">body</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`sha1=`</span>+crypto.createHmac(<span class="string">'sha1'</span>,SECRET).update(body).digest(<span class="string">'hex'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> server = http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">   <span class="built_in">console</span>.log(req.method,req.url);</span><br><span class="line">   <span class="keyword">if</span>(req.method == <span class="string">'POST'</span> &amp;&amp; req.url == <span class="string">'/webhook'</span>)&#123;</span><br><span class="line">       <span class="keyword">let</span> buffers = [];</span><br><span class="line">       req.on(<span class="string">'data'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">buffer</span>)</span>&#123;</span><br><span class="line">           buffers.push(buffer);</span><br><span class="line">       &#125;);</span><br><span class="line">       req.on(<span class="string">'end'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">buffer</span>)</span>&#123;</span><br><span class="line">           <span class="keyword">let</span> body = Buffer.concat(buffers);</span><br><span class="line">           <span class="keyword">let</span> event = req.headers[<span class="string">'x-github-event'</span>]; <span class="comment">//event=push</span></span><br><span class="line">           <span class="comment">//github请求来的时候，要传递请求体body,另外还会传一个signature过来，需要验证签名</span></span><br><span class="line">           <span class="keyword">let</span> signature = req.headers[<span class="string">'x-hub-signature'</span>];</span><br><span class="line">           <span class="keyword">if</span>(signature  !== sign(body))&#123;</span><br><span class="line">             <span class="keyword">return</span> res.send(<span class="string">'Not Allowed'</span>);</span><br><span class="line">           &#125;</span><br><span class="line">           res.setHeader(<span class="string">'Content-Type'</span>,<span class="string">'application/json'</span>);</span><br><span class="line">           res.send(<span class="built_in">JSON</span>.stringify(&#123;<span class="attr">ok</span>:<span class="literal">true</span>&#125;));</span><br><span class="line">           <span class="keyword">if</span>(event == <span class="string">'push'</span>)&#123;<span class="comment">//开始布署</span></span><br><span class="line">                <span class="keyword">let</span> payload = <span class="built_in">JSON</span>.parse(body);</span><br><span class="line">                <span class="keyword">let</span> child = spawn(<span class="string">'sh'</span>,[<span class="string">`./<span class="subst">$&#123;payload.repository.name&#125;</span>.sh`</span>]);</span><br><span class="line">                <span class="keyword">let</span> buffers = [];</span><br><span class="line">                child.stdout.on(<span class="string">'data'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">buffer</span>)</span>&#123;</span><br><span class="line">                    buffers.push(buffer);</span><br><span class="line">                &#125;);</span><br><span class="line">                 child.stdout.on(<span class="string">'end'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">buffer</span>)</span>&#123;</span><br><span class="line">                    <span class="keyword">let</span> logs = Buffer.concat(buffers).toString();</span><br><span class="line">                    sendMail(<span class="string">`</span></span><br><span class="line"><span class="string">                        &lt;h1&gt;部署日期: <span class="subst">$&#123;<span class="keyword">new</span> <span class="built_in">Date</span>()&#125;</span>&lt;/h1&gt;</span></span><br><span class="line"><span class="string">                        &lt;h2&gt;部署人: <span class="subst">$&#123;payload.pusher.name&#125;</span>&lt;/h2&gt;</span></span><br><span class="line"><span class="string">                        &lt;h2&gt;部署邮箱: <span class="subst">$&#123;payload.pusher.email&#125;</span>&lt;/h2&gt;</span></span><br><span class="line"><span class="string">                        &lt;h2&gt;提交信息: <span class="subst">$&#123;payload.head_commit&amp;&amp;payload.head_commit[<span class="string">'message'</span>]&#125;</span>&lt;/h2&gt;</span></span><br><span class="line"><span class="string">                        &lt;h2&gt;布署日志: <span class="subst">$&#123;logs.replace(<span class="string">"\r\n"</span>,<span class="string">'&lt;br/&gt;'</span>)&#125;</span>&lt;/h2&gt;</span></span><br><span class="line"><span class="string">                    `</span>);</span><br><span class="line">                &#125;);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;);</span><br><span class="line">      </span><br><span class="line">   &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">       res.send(<span class="string">'Not Found'</span>);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;);</span><br><span class="line">server.listen(<span class="number">4000</span>,()=&gt;&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Webhook Run Port：4000'</span>)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h3 id="4-3-sendMail-js"><a href="#4-3-sendMail-js" class="headerlink" title="4.3 sendMail.js"></a>4.3 sendMail.js</h3><ul>
<li><a href="https://nodemailer.com/smtp/well-known/" target="_blank" rel="noopener">nodemailer</a></li>
</ul>
<p>/usr/projects/vue-webhook/sendMail.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> nodemailer = <span class="built_in">require</span>(<span class="string">'nodemailer'</span>);</span><br><span class="line"><span class="keyword">let</span> transporter = nodemailer.createTransport(&#123;</span><br><span class="line">    <span class="comment">// host: 'smtp.ethereal.email',</span></span><br><span class="line">    service: <span class="string">'qq'</span>, <span class="comment">// 使用了内置传输发送邮件 查看支持列表：https://nodemailer.com/smtp/well-known/</span></span><br><span class="line">    port: <span class="number">465</span>, <span class="comment">// SMTP 端口</span></span><br><span class="line">    secureConnection: <span class="literal">true</span>, <span class="comment">// 使用了 SSL</span></span><br><span class="line">    auth: &#123;</span><br><span class="line">        user: <span class="string">'283023603@qq.com'</span>,</span><br><span class="line">        <span class="comment">// smtp授权码</span></span><br><span class="line">        pass: <span class="string">'zpdfteyhjfbpcaff'</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sendMail</span>(<span class="params">message</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> mailOptions = &#123;</span><br><span class="line">        <span class="keyword">from</span>: <span class="string">'"Avril Li" &lt;283023603@qq.com&gt;'</span>, <span class="comment">// 发送地址</span></span><br><span class="line">        to: <span class="string">'283023603@qq.com'</span>, <span class="comment">// 接收者</span></span><br><span class="line">        subject: <span class="string">'部署通知'</span>, <span class="comment">// 主题 </span></span><br><span class="line">        html:message <span class="comment">// 内容主体</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// send mail with defined transport object</span></span><br><span class="line">    transporter.sendMail(mailOptions, (error, info) =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (error) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">console</span>.log(error);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'Message sent: %s'</span>, info.messageId);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = sendMail;</span><br><span class="line"><span class="string">`</span></span><br></pre></td></tr></table></figure></p>
<h3 id="4-4-package-json"><a href="#4-4-package-json" class="headerlink" title="4.4 package.json"></a>4.4 package.json</h3><p>/usr/projects/vue-webhook/package.json</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  "name": "vue-webhooks",</span><br><span class="line">  "version": "1.0.0",</span><br><span class="line">  "description": "",</span><br><span class="line">  "main": "index.js",</span><br><span class="line">  "scripts": &#123;</span><br><span class="line"><span class="addition">+    "start": "pm2 start ./webhook.js --watch --name='vue-webhook'",</span></span><br><span class="line"><span class="addition">+    "stop": "pm2 stop vue-webhook"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  "keywords": [],</span><br><span class="line">  "author": "",</span><br><span class="line">  "license": "ISC",</span><br><span class="line">  "dependencies": &#123;</span><br><span class="line">    "nodemailer": "^6.3.0"</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5-配置服务器"><a href="#5-配置服务器" class="headerlink" title="5. 配置服务器"></a>5. 配置服务器</h2><h3 id="5-1-更新系统"><a href="#5-1-更新系统" class="headerlink" title="5.1 更新系统"></a>5.1 更新系统</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#升级所有包同时也升级软件和系统内核</span><br><span class="line">yum update </span><br><span class="line">#只升级所有包，不升级软件和系统内核</span><br><span class="line">yum upgrade</span><br></pre></td></tr></table></figure>
<h3 id="5-2-docker是什么"><a href="#5-2-docker是什么" class="headerlink" title="5.2 docker是什么?"></a>5.2 docker是什么?</h3><ul>
<li>Docker 属于 Linux 容器的一种封装，提供简单易用的容器使用接口。</li>
<li>Docker 将应用程序与该程序的依赖，打包在一个文件里面。运行这个文件，就会生成一个虚拟容器。程序在这个虚拟容器里运行，就好像在真实的物理机上运行一样</li>
</ul>
<p><img src="/images/dockercontainer.png" alt="dockercontainer"></p>
<h3 id="5-3-安装docker"><a href="#5-3-安装docker" class="headerlink" title="5.3 安装docker"></a>5.3 安装docker</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum install -y yum-utils   device-mapper-persistent-data   lvm2</span><br><span class="line">yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    https:<span class="comment">//mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span></span><br><span class="line">yum install -y docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure>
<h3 id="5-4-阿里云加速"><a href="#5-4-阿里云加速" class="headerlink" title="5.4 阿里云加速"></a>5.4 阿里云加速</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /etc/docker</span><br><span class="line">tee /etc/docker/daemon.json &lt;&lt;-<span class="string">'EOF'</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"registry-mirrors"</span>: [<span class="string">"https://fwvjnv59.mirror.aliyuncs.com"</span>]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line"># 重载所有修改过的配置文件</span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure>
<h3 id="5-5-生成公钥并添加github"><a href="#5-5-生成公钥并添加github" class="headerlink" title="5.5 生成公钥并添加github"></a>5.5 生成公钥并添加github</h3><ul>
<li><a href="https://github.com/settings/keys" target="_blank" rel="noopener">https://github.com/settings/keys</a></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">"&lt;your.name&gt;@qq.com</span></span><br><span class="line"><span class="string">cat /root/.ssh/id_rsa.pub</span></span><br></pre></td></tr></table></figure>
<h3 id="5-6-安装git"><a href="#5-6-安装git" class="headerlink" title="5.6 安装git"></a>5.6 安装git</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum install git -y</span><br><span class="line">git clone git@github.com:<span class="xml"><span class="tag">&lt;<span class="name">your.git.name</span>&gt;</span>/vue-front.git</span></span><br><span class="line">git clone git@github.com:&lt;your.git.name&gt;/vue-back.git</span><br><span class="line">git clone git@github.com:&lt;your.git.name&gt;/vue-webhook.git</span><br></pre></td></tr></table></figure>
<p>~.gitconfig<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[alias]</span><br><span class="line">    a = add -A</span><br><span class="line">    c = commit -m<span class="string">"msg"</span></span><br><span class="line">    p = push origin master</span><br></pre></td></tr></table></figure></p>
<h3 id="5-7-安装node和npm"><a href="#5-7-安装node和npm" class="headerlink" title="5.7 安装node和npm"></a>5.7 安装node和npm</h3><ul>
<li><a href="https://github.com/nvm-sh/nvm" target="_blank" rel="noopener">NVM</a> Node.js多版本管理</li>
<li><a href="https://www.npmjs.com/package/nrm" target="_blank" rel="noopener">NRM</a> NPM源的切换<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget -qO- https:<span class="comment">//raw.githubusercontent.com/nvm-sh/nvm/v0.34.0/install.sh | bash</span></span><br><span class="line">source /root/.bashrc</span><br><span class="line"># 安装最新的Node稳定版本</span><br><span class="line">nvm install stable</span><br><span class="line">npm i nrm -g</span><br><span class="line">nrm use taobao</span><br><span class="line">npm i pm2 -g</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="5-8-安装启动服务"><a href="#5-8-安装启动服务" class="headerlink" title="5.8 安装启动服务"></a>5.8 安装启动服务</h3><h4 id="5-8-1-vue-back"><a href="#5-8-1-vue-back" class="headerlink" title="5.8.1 vue-back"></a>5.8.1 vue-back</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/projects/vue-back</span><br><span class="line">npm i </span><br><span class="line">npm run start</span><br><span class="line">curl http:<span class="comment">//localhost:3000</span></span><br></pre></td></tr></table></figure>
<h4 id="5-8-2-vue-front"><a href="#5-8-2-vue-front" class="headerlink" title="5.8.2 vue-front"></a>5.8.2 vue-front</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/projects/vue-front</span><br><span class="line">npm i </span><br><span class="line">npm run serve</span><br><span class="line">curl http:<span class="comment">//localhost:8080</span></span><br></pre></td></tr></table></figure>
<h4 id="5-8-3-vue-webhook"><a href="#5-8-3-vue-webhook" class="headerlink" title="5.8.3 vue-webhook"></a>5.8.3 vue-webhook</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/projects/vue-webhook</span><br><span class="line">npm i</span><br><span class="line">npm run start </span><br><span class="line">curl http:<span class="comment">//localhost:4000</span></span><br><span class="line">curl http:<span class="comment">//47.104.15.123:4000/webhook</span></span><br></pre></td></tr></table></figure>
<h2 id="6-后台布署"><a href="#6-后台布署" class="headerlink" title="6. 后台布署"></a>6. 后台布署</h2><h3 id="6-1-vue-back-sh"><a href="#6-1-vue-back-sh" class="headerlink" title="6.1 vue-back.sh"></a>6.1 vue-back.sh</h3><p>/usr/projects/vue-webhook/vue-back.sh<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">WORK_PATH=<span class="string">'/usr/projects/vue-back'</span></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$WORK_PATH</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"清理代码"</span></span><br><span class="line">git reset --hard origin/master</span><br><span class="line">git clean -f</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"拉取最新代码"</span></span><br><span class="line">git pull origin master</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"开始构建镜像"</span></span><br><span class="line">docker build -t vue-back .</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"删除旧容器"</span></span><br><span class="line">docker stop vue-back-container</span><br><span class="line">docker rm vue-back-container</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"启动新容器"</span></span><br><span class="line">docker container run -p 3000:3000 -d --name vue-back-container vue-back</span><br></pre></td></tr></table></figure></p>
<h3 id="6-2-Dockerfile"><a href="#6-2-Dockerfile" class="headerlink" title="6.2 Dockerfile"></a>6.2 Dockerfile</h3><p>/usr/projects/vue-back/Dockerfile<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">FROM node</span><br><span class="line">LABEL name=&quot;vue-back&quot;</span><br><span class="line">LABEL version=&quot;1.0&quot;</span><br><span class="line">COPY . /app</span><br><span class="line">WORKDIR /app</span><br><span class="line">RUN npm install</span><br><span class="line">EXPOSE 3000</span><br><span class="line">CMD npm start</span><br></pre></td></tr></table></figure></p>
<h3 id="6-3-dockerignore"><a href="#6-3-dockerignore" class="headerlink" title="6.3 .dockerignore"></a>6.3 .dockerignore</h3><p>/usr/projects/vue-back/.dockerignore<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.git</span><br><span class="line">node_modules</span><br><span class="line">package-lock.json</span><br><span class="line">Dockerfile</span><br><span class="line">.dockerignore</span><br></pre></td></tr></table></figure></p>
<h2 id="7-前台布署"><a href="#7-前台布署" class="headerlink" title="7. 前台布署"></a>7. 前台布署</h2><h3 id="7-1-vue-front-sh"><a href="#7-1-vue-front-sh" class="headerlink" title="7.1 vue-front.sh"></a>7.1 vue-front.sh</h3><p>/usr/projects/vue-webhook/vue-front.sh<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">WORK_PATH=<span class="string">'/usr/projects/vue-front'</span></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$WORK_PATH</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"清理代码"</span></span><br><span class="line">git reset --hard origin/master</span><br><span class="line">git clean -f</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"拉取最新代码"</span></span><br><span class="line">git pull origin master</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"打包最新代码"</span></span><br><span class="line">npm run build</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"开始构建镜像"</span></span><br><span class="line">docker build -t vue-front .</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"删除旧容器"</span></span><br><span class="line">docker stop vue-front-container</span><br><span class="line">docker rm vue-front-container</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"启动新容器"</span></span><br><span class="line">docker container run -p 80:80 -d --name vue-front-container vue-front</span><br></pre></td></tr></table></figure></p>
<h3 id="7-2-Dockerfile"><a href="#7-2-Dockerfile" class="headerlink" title="7.2 Dockerfile"></a>7.2 Dockerfile</h3><p>/usr/projects/vue-front/Dockerfile<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">FROM nginx</span><br><span class="line">LABEL name=&quot;vue-front&quot;</span><br><span class="line">LABEL version=&quot;1.0&quot;</span><br><span class="line">COPY  ./dist/ /usr/share/nginx/html/</span><br><span class="line">COPY ./vue-front.conf /etc/nginx/conf.d/</span><br><span class="line">EXPOSE 80</span><br></pre></td></tr></table></figure></p>
<h3 id="7-3-vue-front-conf"><a href="#7-3-vue-front-conf" class="headerlink" title="7.3 vue-front.conf"></a>7.3 vue-front.conf</h3><p>/usr/projects/vue-front/vue-front.conf<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  47.104.15.123;</span><br><span class="line">    location / &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">        index  index.html index.htm;</span><br><span class="line">        try_files $uri $uri/ /index.html;</span><br><span class="line">    &#125;</span><br><span class="line">    location /api &#123;</span><br><span class="line">      proxy_pass http://47.104.15.123:3000;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="7-4-dockerignore"><a href="#7-4-dockerignore" class="headerlink" title="7.4  .dockerignore"></a>7.4  .dockerignore</h3><p>/usr/projects/vue-front/.dockerignore<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.git</span><br><span class="line">node_modules</span><br><span class="line">package-lock.json</span><br><span class="line">Dockerfile</span><br><span class="line">.dockerignore</span><br></pre></td></tr></table></figure></p>
<h2 id="8-集成部署"><a href="#8-集成部署" class="headerlink" title="8. 集成部署"></a>8. 集成部署</h2><ul>
<li>Compose 通过一个配置文件来管理多个Docker容器</li>
<li>在配置文件中，所有的容器通过services来定义，然后使用docker-compose脚本来启动、停止和重启应用和应用中的服务以及所有依赖服务的容器</li>
<li>最后，运行docker-compose up，Compose 将启动并运行整个应用程序 配置文件组成</li>
</ul>
<h3 id="8-1-docker-compose-yml"><a href="#8-1-docker-compose-yml" class="headerlink" title="8.1 docker-compose.yml"></a>8.1 docker-compose.yml</h3><p>/usr/projects/docker-compose.yml<br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">'2'</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr"> api:</span></span><br><span class="line"><span class="attr">  build:</span></span><br><span class="line"><span class="attr">    context:</span> <span class="string">./vue-back</span></span><br><span class="line"><span class="attr">    dockerfile:</span> <span class="string">Dockerfile</span></span><br><span class="line"><span class="attr">  ports:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">"3000:3000"</span></span><br><span class="line"><span class="attr"> web:</span></span><br><span class="line"><span class="attr">  build:</span></span><br><span class="line"><span class="attr">    context:</span> <span class="string">./vue-front</span></span><br><span class="line"><span class="attr">    dockerfile:</span> <span class="string">Dockerfile</span></span><br><span class="line"><span class="attr">  ports:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">"80:80"</span></span><br></pre></td></tr></table></figure></p>
<h3 id="8-2-安装docker-compose"><a href="#8-2-安装docker-compose" class="headerlink" title="8.2 安装docker-compose"></a>8.2 安装docker-compose</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -L https:<span class="comment">//github.com/docker/compose/releases/download/1.23.2/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose</span></span><br><span class="line">chmod +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>
<h3 id="8-3-启动服务"><a href="#8-3-启动服务" class="headerlink" title="8.3 启动服务"></a>8.3 启动服务</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up</span><br><span class="line">docker-compuse up -d</span><br></pre></td></tr></table></figure>
<h3 id="8-4-cicd-sh"><a href="#8-4-cicd-sh" class="headerlink" title="8.4 cicd.sh"></a>8.4 cicd.sh</h3><p>/usr/projects/vue-webhook/cicd.sh<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">WORK_PATH=<span class="string">'/usr/projects/vue-back'</span></span><br><span class="line">cd $WORK_PATH</span><br><span class="line">echo <span class="string">"清理后台代码"</span></span><br><span class="line">git reset --hard origin/master</span><br><span class="line">git clean -f</span><br><span class="line">echo <span class="string">"拉取后台最新代码"</span></span><br><span class="line">git pull origin master</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">WORK_PATH=<span class="string">'/usr/projects/vue-front'</span></span><br><span class="line">cd $WORK_PATH</span><br><span class="line">echo <span class="string">"清理前台代码"</span></span><br><span class="line">git reset --hard origin/master</span><br><span class="line">git clean -f</span><br><span class="line">echo <span class="string">"拉取前台最新代码"</span></span><br><span class="line">git pull origin master</span><br><span class="line">echo <span class="string">"打包前台最新代码"</span></span><br><span class="line">npm run build</span><br><span class="line"></span><br><span class="line">cd /usr/projects</span><br><span class="line">echo <span class="string">"删除老资源"</span></span><br><span class="line">docker-compose down</span><br><span class="line">echo <span class="string">"重启所有服务"</span></span><br><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope="" itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.avrils.cc/09/19/mini-vuex/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Avril Li">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/logo.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Avril的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/09/19/mini-vuex/" itemprop="url">
                  Mini Vuex
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-19T10:26:21+08:00">
                2019-09-19
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/" itemprop="url" rel="index">
                    <span itemprop="name">Vue</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>接着上篇，把手写简单版vuex也总结一下做个笔记。手写vuex很多东西是跟vue-router相似的，相同的东西不再赘述。</p>
<p>惯例，先上个Vuex的图：<br><img src="/images/vuex.png" alt=""></p>
<p>然后上代码：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Vue</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Store</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(options) &#123;</span><br><span class="line">    <span class="comment">// state要实时更新，就要变成响应式数据</span></span><br><span class="line">    <span class="comment">// 通过new Vue产生新的实例，对应产生getter和setter, 若数据更新则视图刷新</span></span><br><span class="line">    <span class="comment">// 和Vue.util.defineReactive效果一样，只是原码上是以这种方式</span></span><br><span class="line">    <span class="comment">// PS: 这句是核心呐</span></span><br><span class="line">    <span class="keyword">this</span>._vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">      data: &#123; <span class="attr">state</span>: options.state &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">this</span>.state = <span class="keyword">this</span>._vm.state</span><br><span class="line">    <span class="keyword">this</span>.mutations = options.mutations</span><br><span class="line">    <span class="keyword">this</span>.actions = options.actions</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 执行commit的事件后调到对应方法并执行</span></span><br><span class="line">  commit = <span class="function">(<span class="params">eventName</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.mutations[eventName](<span class="keyword">this</span>.state)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 执行actions里的对应方法，this是当前Store可解构出commit</span></span><br><span class="line">  dispatch = <span class="function">(<span class="params">eventName</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.actions[eventName](<span class="keyword">this</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 提供install方法</span></span><br><span class="line"><span class="keyword">const</span> install = <span class="function">(<span class="params">_Vue</span>) =&gt;</span> &#123;</span><br><span class="line">  Vue = _Vue</span><br><span class="line">  Vue.mixin(&#123;</span><br><span class="line">    beforeCreate() &#123;</span><br><span class="line">      <span class="comment">// 组件加载是深度优先</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.$options &amp;&amp; <span class="keyword">this</span>.$options.store) &#123;</span><br><span class="line">        <span class="keyword">this</span>.$store = <span class="keyword">this</span>.$options.store</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.$store = <span class="keyword">this</span>.$parent &amp;&amp; <span class="keyword">this</span>.$parent.$store</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出类，对应new Vue.Store()和Vue.use()</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  Store,</span><br><span class="line">  install</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>然后，还有个优化版的，参考于姜老师的资料，不作阐述。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Vue</span><br><span class="line"><span class="keyword">const</span> forEach = <span class="function">(<span class="params">obj, callback</span>) =&gt;</span> <span class="built_in">Object</span>.keys(obj).forEach(<span class="function"><span class="params">key</span> =&gt;</span> callback(key, obj[key]))</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Store</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(options) &#123;</span><br><span class="line">    <span class="keyword">this</span>.getters = &#123;&#125;</span><br><span class="line">    <span class="keyword">this</span>._vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">      data: &#123;</span><br><span class="line">        state: options.state</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">const</span> &#123; getters &#125; = options</span><br><span class="line">    <span class="keyword">if</span> (getters) &#123;</span><br><span class="line">      <span class="built_in">Object</span>.keys(getters).forEach(<span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(<span class="keyword">this</span>.getters, key, &#123;</span><br><span class="line">          <span class="comment">// 定义getters</span></span><br><span class="line">          get: <span class="function"><span class="params">()</span> =&gt;</span> getters[key](<span class="keyword">this</span>.state)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.mutations = &#123;&#125;</span><br><span class="line">    <span class="keyword">const</span> &#123; mutations &#125; = options</span><br><span class="line">    <span class="keyword">if</span> (mutations) &#123;</span><br><span class="line">      forEach(mutations, (key, value) =&gt; &#123;</span><br><span class="line">        <span class="keyword">this</span>.mutations[key] = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">          value.call(<span class="keyword">this</span>, <span class="keyword">this</span>.state)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> &#123; actions &#125; = options</span><br><span class="line">    <span class="keyword">if</span> (actions) &#123;</span><br><span class="line">      forEach(actions, (key, value) =&gt; &#123;</span><br><span class="line">        <span class="keyword">this</span>.actions[key] = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">          value.call(<span class="keyword">this</span>, <span class="keyword">this</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  get state() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._vm.state</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  commit = <span class="function">(<span class="params">eventName</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.mutations(<span class="keyword">this</span>, eventName)</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  dispatch = <span class="function">(<span class="params">eventName</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.actions(<span class="keyword">this</span>, eventName)</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 提供install方法</span></span><br><span class="line"><span class="keyword">const</span> install = <span class="function">(<span class="params">_Vue</span>) =&gt;</span> &#123;</span><br><span class="line">  Vue = _Vue</span><br><span class="line">  Vue.mixin(&#123;</span><br><span class="line">    beforeCreate() &#123;</span><br><span class="line">      <span class="comment">// 组件加载是深度优先</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.$options &amp;&amp; <span class="keyword">this</span>.$options.store) &#123;</span><br><span class="line">        <span class="keyword">this</span>.$store = <span class="keyword">this</span>.$options.store</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.$store = <span class="keyword">this</span>.$parent &amp;&amp; <span class="keyword">this</span>.$parent.$store</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  Store,</span><br><span class="line">  install</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope="" itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.avrils.cc/09/18/mini-vue-router/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Avril Li">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/logo.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Avril的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/09/18/mini-vue-router/" itemprop="url">
                  Mini vue-router
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-18T10:43:57+08:00">
                2019-09-18
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/" itemprop="url" rel="index">
                    <span itemprop="name">Vue</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>前段时间听了点课，结合自己的理解把关于手写简单的vue-router做个笔记吧。不废话了，上代码。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用于获取当前Vue</span></span><br><span class="line"><span class="keyword">let</span> Vue</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 声明VueRouter类</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">（PS：函数声明会提升，类声明不会。</span></span><br><span class="line"><span class="comment">要先声明你的类，然后才能访问它，否则会抛出ReferenceError）</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Router</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(&#123; routes &#125;) &#123;</span><br><span class="line">    <span class="comment">// 7. 映射路由表</span></span><br><span class="line">    <span class="keyword">this</span>.routeMap = routes.reduce(<span class="function">(<span class="params">memo, route</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 把path作为key，组件为value</span></span><br><span class="line">      memo[route.path] = route.component</span><br><span class="line">      <span class="keyword">return</span> memo</span><br><span class="line">    &#125;, &#123;&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 9. 把当前路径属性定义成响应式数据，视图才刷新</span></span><br><span class="line">    <span class="comment">// 或Vue.util.defineReactive(this.route = &#123;&#125;, 'path', '/')</span></span><br><span class="line">    <span class="comment">// 也可以用Vue.$set但是内部源码里用的是这个</span></span><br><span class="line">    Vue.util.defineReactive(<span class="keyword">this</span>, <span class="string">'route'</span>, &#123; <span class="attr">path</span>: <span class="string">'/'</span> &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 10. 页面加载的时候跳转（这里只处理hash的跳转）</span></span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">'load'</span>, () =&gt; &#123;</span><br><span class="line">      <span class="comment">// 页面加载的时候，默认跳转到首页</span></span><br><span class="line">      location.hash ? <span class="string">''</span> : location.hash = <span class="string">'/'</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// hash更新</span></span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">'hashchange'</span>, () =&gt; &#123;</span><br><span class="line">      <span class="comment">// 跳转到对应路由，把#去掉</span></span><br><span class="line">      <span class="keyword">this</span>.route.path = location.hash.slice(<span class="number">1</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 提供一个install方法来全局注册该组件（对应Vue.use()）</span></span><br><span class="line"><span class="comment">// 可以扩展属性/组件/指令</span></span><br><span class="line">Router.install = <span class="function"><span class="keyword">function</span>(<span class="params">_Vue</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// _Vue是当前Vue的构造函数</span></span><br><span class="line">  Vue = _Vue</span><br><span class="line">  <span class="comment">// 3. 在beforeCreate的时候把router的定义mixin到所有的Vue实例</span></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  （PS: 让每个组件都能共享router实例，可以Vue.prototype.router，</span></span><br><span class="line"><span class="comment">  但是这样就每个new Vue都会有这个属性，</span></span><br><span class="line"><span class="comment">  实际上我们只需要main.js/App.vue开始的才拥有，所以要给每个组件单独添加router）</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  Vue.mixin(&#123;</span><br><span class="line">    beforeCreate() &#123;</span><br><span class="line">      <span class="comment">// 4. 先找根组件，再一层层往下</span></span><br><span class="line">      <span class="comment">// 确保只有配置了router的Vue实例根节点及其子孙节点才有对应的router</span></span><br><span class="line">      <span class="comment">// this.$options即new Vue(&#123;...router&#125;), 只有根组件才会传这个对象</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.$options &amp;&amp; <span class="keyword">this</span>.$options.router) &#123;</span><br><span class="line">        <span class="comment">// 保存当前的router</span></span><br><span class="line">        <span class="keyword">this</span>._router = <span class="keyword">this</span>.$options.router</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 让所有的子组件都有_router属性指向当前的router(即传进来的new Router实例)</span></span><br><span class="line">        <span class="comment">// 若Router中有属性p，则可获取到this._router.p的值</span></span><br><span class="line">        <span class="keyword">this</span>._router = <span class="keyword">this</span>.$parent &amp;&amp; <span class="keyword">this</span>.$parent._router</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 5. 给每个组件添加$route和$routers属性，即_router</span></span><br><span class="line">      <span class="built_in">Object</span>.defineProperty(<span class="keyword">this</span>, <span class="string">'$route'</span>, &#123;</span><br><span class="line">        value: &#123;</span><br><span class="line">          route: <span class="keyword">this</span>._router.route</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="built_in">Object</span>.defineProperty(<span class="keyword">this</span>, <span class="string">'$router'</span>, &#123;</span><br><span class="line">        value: &#123;</span><br><span class="line">          route: <span class="keyword">this</span>._router.route</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 6. 定义路由两大组件&lt;router-link&gt;和&lt;router-view&gt;</span></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  (PS：如果放进mixin里面，会重复定义，但是vue会判断，所以也不会影响，但最好是各司其职)</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  Vue.component(<span class="string">'router-link'</span>, &#123;</span><br><span class="line">    props: &#123;</span><br><span class="line">      to: &#123;</span><br><span class="line">        type: <span class="built_in">String</span>,</span><br><span class="line">        <span class="keyword">default</span>: <span class="string">'/'</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    render(h) &#123;</span><br><span class="line">      <span class="comment">// 获取router-link,实际就是个a标签</span></span><br><span class="line">      <span class="comment">// PS：此处目前只处理了hash类型的路由分配所以是#</span></span><br><span class="line">      <span class="comment">// this.$slots.default 即默认的标签的内容</span></span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#123;</span>`#$&#123;<span class="attr">this.to</span>&#125;`&#125;&gt;</span>&#123;this.$slots.default&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 8. 显示对应的组件</span></span><br><span class="line">  Vue.component(<span class="string">'router-view'</span>, &#123;</span><br><span class="line">    render(h) &#123;</span><br><span class="line">      <span class="comment">// 根据路由表里的组件路径，渲染组件</span></span><br><span class="line">      <span class="keyword">return</span> h(<span class="keyword">this</span>._router.routeMap[<span class="keyword">this</span>.$route.route.path])</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 把这个组件类导出，在router.js中引用</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Router</span><br></pre></td></tr></table></figure>
<p>Router层级关系图：<br><img src="/images/vue-router.png" alt=""></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope="" itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.avrils.cc/09/16/vue组件通信/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Avril Li">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/logo.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Avril的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/09/16/vue组件通信/" itemprop="url">
                  Vue组件间的通信方式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-16T18:15:36+08:00">
                2019-09-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/" itemprop="url" rel="index">
                    <span itemprop="name">Vue</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>PS：加班使我麻木，终于想起来要更一下博客了。<br>Vue组件间的通信方式是老生常谈了，所以必不可免地简单地归纳一下。主要分为八个方向：Props传递数据，$emit，$parent+$children，$attrs+$listeners，Provide+Inject，Ref，EventBus，Vuex</p>
<h2 id="1-Props传递数据（父传子）"><a href="#1-Props传递数据（父传子）" class="headerlink" title="1. Props传递数据（父传子）"></a>1. Props传递数据（父传子）</h2><p>父组件调用子组件<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  父组件:&#123;&#123;msg&#125;&#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">Son</span> <span class="attr">:msg</span>=<span class="string">"msg"</span>&gt;</span><span class="tag">&lt;/<span class="name">Son</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> Son <span class="keyword">from</span> <span class="string">"./Son"</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="undefined"> components: &#123;</span></span><br><span class="line"><span class="undefined">  Son</span></span><br><span class="line"><span class="undefined"> &#125;,</span></span><br><span class="line"><span class="undefined"> data() &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">return</span> &#123; <span class="attr">msg</span>: <span class="string">'From Father'</span> &#125;;</span></span><br><span class="line"><span class="undefined"> &#125;</span></span><br><span class="line"><span class="undefined">&#125;;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>子组件获取数据<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>来自父组件的消息：&#123;&#123; msg &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">'Son'</span>,</span></span><br><span class="line"><span class="undefined">  props: &#123;</span></span><br><span class="line"><span class="undefined">    msg: &#123;</span></span><br><span class="line"><span class="javascript">      type: <span class="built_in">String</span>,</span></span><br><span class="line"><span class="javascript">      required: <span class="literal">true</span></span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="2-emit传递数据"><a href="#2-emit传递数据" class="headerlink" title="2. $emit传递数据"></a>2. $emit传递数据</h2><p>子组件触发父组件方法,通过回调的方式将修改的内容传递给父组件<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    父组件:&#123;&#123; price &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">Son</span> <span class="attr">:price</span>=<span class="string">"price"</span> @<span class="attr">input</span>=<span class="string">"change"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> Son <span class="keyword">from</span> <span class="string">'./Son'</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="undefined">  components: &#123;</span></span><br><span class="line"><span class="undefined">    Son</span></span><br><span class="line"><span class="undefined">  &#125;,</span></span><br><span class="line"><span class="undefined">  data() &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123; <span class="attr">price</span>: <span class="number">100</span> &#125;</span></span><br><span class="line"><span class="undefined">  &#125;,</span></span><br><span class="line"><span class="undefined">  methods: &#123;</span></span><br><span class="line"><span class="undefined">    change(price) &#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">this</span>.price = price</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>子组件触发绑定自己身上的方法<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    子组件: &#123;&#123; price &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"$emit('input',200)"</span>&gt;</span>更改<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="undefined">  props: &#123;</span></span><br><span class="line"><span class="undefined">    price: &#123;</span></span><br><span class="line"><span class="javascript">      type: <span class="built_in">Number</span>,</span></span><br><span class="line"><span class="javascript">      required: <span class="literal">true</span></span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><code>.sync</code><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Son</span> <span class="attr">:price.sync</span>=<span class="string">"price"</span>&gt;</span><span class="tag">&lt;/<span class="name">Son</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 触发的事件名 update:(绑定.sync属性的名字) --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"$emit('update:price',200)"</span>&gt;</span>更改<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><code>v-model</code><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 父组件调用子组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Son</span> <span class="attr">v-model</span>=<span class="string">"price"</span>&gt;</span><span class="tag">&lt;/<span class="name">Son</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 子组件触发更改 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    子组件: &#123;&#123; value &#125;&#125;</span><br><span class="line">    // 触发的事件只能是input</span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"$emit('input',200)"</span>&gt;</span>更改<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="undefined">  props: &#123;</span></span><br><span class="line"><span class="javascript">    value: &#123; <span class="comment">// 接收到的属性名只能叫value</span></span></span><br><span class="line"><span class="javascript">      type: <span class="built_in">Number</span>,</span></span><br><span class="line"><span class="javascript">      required: <span class="literal">true</span></span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="3-parent、-children"><a href="#3-parent、-children" class="headerlink" title="3. $parent、$children"></a>3. $parent、$children</h2><p>父传子，子传孙。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 子组件调用孙子组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Grandson</span> <span class="attr">:value</span>=<span class="string">"value"</span>&gt;</span><span class="tag">&lt;/<span class="name">Grandson</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 孙子组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    孙子:&#123;&#123; value &#125;&#125;</span><br><span class="line">    <span class="comment">&lt;!-- 调用父组件的input事件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"$parent.$emit('input',200)"</span>&gt;</span>更改<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="undefined">  props: &#123;</span></span><br><span class="line"><span class="undefined">    value: &#123;</span></span><br><span class="line"><span class="javascript">      type: <span class="built_in">Number</span>,</span></span><br><span class="line"><span class="javascript">      required: <span class="literal">true</span></span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>如果层级很深那么就会出现$parent.$parent…..可以封装一个$dispatch方法向上进行派发</p>
</blockquote>
<p><code>$dispatch</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Vue.prototype.$dispatch = <span class="function"><span class="keyword">function</span> <span class="title">$dispatch</span>(<span class="params">eventName, data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> parent = <span class="keyword">this</span>.$parent</span><br><span class="line">  <span class="keyword">while</span> (parent) &#123;</span><br><span class="line">    parent.$emit(eventName, data)</span><br><span class="line">    parent = parent.$parent</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>同理，可以向上派发</p>
</blockquote>
<p><code>$broadcast</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Vue.prototype.$broadcast = <span class="function"><span class="keyword">function</span> <span class="title">$broadcast</span>(<span class="params">eventName, data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> broadcast = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.$children.forEach(<span class="function">(<span class="params">child</span>) =&gt;</span> &#123;</span><br><span class="line">      child.$emit(eventName, data)</span><br><span class="line">      <span class="keyword">if</span> (child.$children) &#123;</span><br><span class="line">        $broadcast.call(child, eventName, data)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  broadcast.call(<span class="keyword">this</span>, eventName, data)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="4-attrs、-listeners"><a href="#4-attrs、-listeners" class="headerlink" title="4. $attrs、$listeners"></a>4. $attrs、$listeners</h2><blockquote>
<p>批量向下传递属性</p>
</blockquote>
<p><code>$attrs</code><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 父组件调用子组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Son</span> <span class="attr">name</span>=<span class="string">"测试"</span> <span class="attr">age</span>=<span class="string">"10"</span>&gt;</span><span class="tag">&lt;/<span class="name">Son</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 可以在son组件中使用$attrs属性,可以将属性继续向下传递 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  儿子: &#123;&#123;$attrs.name&#125;&#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">Grandson</span> <span class="attr">v-bind</span>=<span class="string">"$attrs"</span>&gt;</span><span class="tag">&lt;/<span class="name">Grandson</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 孙子组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>孙子:&#123;&#123; $attrs &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>批量向上传递属性</p>
</blockquote>
<p><code>$listeners</code><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 父组件调用子组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Son</span> <span class="attr">name</span>=<span class="string">"测试"</span> <span class="attr">age</span>=<span class="string">"10"</span> @<span class="attr">click</span>=<span class="string">"()=&gt;&#123;this.price = 500&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">Son</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 子组件：可以在son组件中使用listeners属性,可以将方法继续向下传递 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Grandson</span> <span class="attr">v-bind</span>=<span class="string">"$attrs"</span> <span class="attr">v-on</span>=<span class="string">"$listeners"</span>&gt;</span><span class="tag">&lt;/<span class="name">Grandson</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 孙子组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"$listeners.click()"</span>&gt;</span>更改<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="5-Provide、-Inject"><a href="#5-Provide、-Inject" class="headerlink" title="5. Provide、 Inject"></a>5. Provide、 Inject</h2><blockquote>
<p>Provie: 在父级中注入数据</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">provide() &#123;</span><br><span class="line">  return &#123; parentMsg: "父亲" &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Inject: 在任意子组件中可以注入父级数据</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 会将数据挂载在当前实例上</span><br><span class="line">inject: ["parentMsg"]</span><br></pre></td></tr></table></figure>
<h2 id="6-Ref获取组件实例"><a href="#6-Ref获取组件实例" class="headerlink" title="6. Ref获取组件实例"></a>6. Ref获取组件实例</h2><p>Ref我常用于调用子组件的属性和方法，简洁明了。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 父级组件调用子级组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Grandson</span> <span class="attr">v-bind</span>=<span class="string">"$attrs"</span> <span class="attr">v-on</span>=<span class="string">"$listeners"</span> <span class="attr">ref</span>=<span class="string">"grand"</span>&gt;</span><span class="tag">&lt;/<span class="name">Grandson</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="undefined">  mounted() &#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 获取组件定义的属性</span></span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.$refs.grand.name)</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="7-EventBus"><a href="#7-EventBus" class="headerlink" title="7. EventBus"></a>7. EventBus</h2><p>其实就是利用一个Vue实例传递数据，实现跨组件通知（简单的项目可以使用此方式）<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Vue.prototype.$bus = <span class="keyword">new</span> Vue()</span><br></pre></td></tr></table></figure></p>
<p>Son组件和Grandson相互通信<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mounted() &#123;</span><br><span class="line">  <span class="keyword">this</span>.$bus.$on(<span class="string">"my"</span>, data =&gt; &#123;</span><br><span class="line">   <span class="built_in">console</span>.log(data);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mounted() &#123;</span><br><span class="line">  <span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">   <span class="keyword">this</span>.$bus.$emit(<span class="string">"my"</span>, <span class="string">"我是Grandson"</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="8-Vuex状态管理"><a href="#8-Vuex状态管理" class="headerlink" title="8. Vuex状态管理"></a>8. Vuex状态管理</h2><p>数据通信交互较多的项目还是用Vuex统一管理吧，具体使用参考Vuex官方文档，在这就放个图。<br><img src="/images/vuex.png" alt=""></p>
<p>最后，总结一波：</p>
<blockquote>
<ul>
<li>父传子： Props, $broadcast, $attrs, $listeners, Provide+Inject</li>
<li>子传父： $emit, $dispatch</li>
<li>父子双向： .sync, v-model</li>
<li>兄弟互传：EventBus, Vuex （PS：也可以都dispatch到最上层父级再派发，但是不建议）</li>
</ul>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope="" itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.avrils.cc/11/23/用户体验那些事/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Avril Li">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/logo.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Avril的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/11/23/用户体验那些事/" itemprop="url">
                  用户体验那些事 About UE
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-23T14:57:57+08:00">
                2018-11-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/UE/" itemprop="url" rel="index">
                    <span itemprop="name">UE</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>PS：频繁地换电脑一度中断了我写博客的心情，嗯，感慨一下，终于。<br>关于用户体验其实有太多的内容可以研究，鉴于之前在工作小组内做过分享，浅显地总结归纳为三个方面：布局优化，内容优化，配色优化。在这里做个简单地总结。</p>
<p>Such conent to study about UE. as the previous sharing in my work team, can be summarized into 3 aspects: layout optimization, content optimization，color matching optimization. Just make a brief summary here.</p>
<h2 id="布局优化-Layout-Optimization"><a href="#布局优化-Layout-Optimization" class="headerlink" title="布局优化 Layout Optimization"></a>布局优化 Layout Optimization</h2><p>布局优化旨在页面组件结构的优化，让页面更简洁美观并且舒适。大致可以归纳成三点:专注主题，保持简洁，适当的突出与柔化<br>Layout optimization is designed to optimize the structure of the page components, making the page more concise and comfortable. It can be roughly summarized into three points: Keep Focus，Keep Concise，Appropriate highlighting and softening</p>
<blockquote>
<p>*Try Merging Similar Functions instead of fragmenting the UI<br><img src="/images/UE1.png" alt=""><br>Example:<br><img src="/images/UE2.png" alt=""></p>
</blockquote>
<blockquote>
<ul>
<li>Try A One Column Layout instead of multi-columns<br><img src="/images/UE3.png" alt=""><br>Example:<br><img src="/images/UE4.png" alt=""></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>Try Recommending instead of showing equal choices<br><img src="/images/UE5.png" alt=""><br>Example:<br><img src="/images/UE6.png" alt=""><br><img src="/images/UE7.png" alt=""></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>Try Friendly Comparisons instead of confusion<br><img src="/images/UE8.png" alt=""><br>Example:<br><img src="/images/UE9.png" alt=""><br><img src="/images/UE10.png" alt=""></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>Try Fewer Borders instead of wasting attention<br><img src="/images/UE11.png" alt=""></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>Try Softer Prompts instead of modal windows<br><img src="/images/UE12.png" alt=""></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>Try line of sight instead of jumping<br><img src="/images/UE13.png" alt="">  <img src="/images/UE14.png" alt=""></li>
</ul>
</blockquote>
<h2 id="内容优化-Contetnt-Optimization"><a href="#内容优化-Contetnt-Optimization" class="headerlink" title="内容优化 Contetnt Optimization"></a>内容优化 Contetnt Optimization</h2><p>内容优化旨在用户交互的内容及流程优化。大致可以归纳成四点：易学性，高效性，满足性，错误处理<br>Contetnt optimization is aimed at the process and content optimization of user interaction.It can be roughly summarized into three points: Learnability，Efficiency，Satisfaction，Error Handle</p>
<blockquote>
<ul>
<li>Try Social Proof instead of talking about yourself<br><img src="/images/UE15.png" alt=""><br>Example:<br><img src="/images/UE16.png" alt=""><br><img src="/images/UE17.png" alt=""></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>Try Fewer Form Fields instead of asking for too many<br><img src="/images/UE18.png" alt=""><br>Example:<br><img src="/images/UE19.png" alt=""></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>Try Undos instead of prompting for confirmation<br><img src="/images/UE20.png" alt=""><br>Example:<br><img src="/images/UE21.png" alt=""></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>Try Set Collections instead of independent items<br><img src="/images/UE22.png" alt=""><br>Example:<br><img src="/images/UE23.png" alt=""></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>Try Telling Who It’s For instead of targeting everyone<br><img src="/images/UE24.png" alt=""></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>Try Exposing Options instead of hiding them<br><img src="/images/UE25.png" alt=""></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>Try Keeping Focus instead of drowning with links<br><img src="/images/UE26.png" alt=""></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>Try Selling Benefits instead of features<br><img src="/images/UE27.png" alt=""></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>Try Opt-Out instead of opt-in<br><img src="/images/UE28.png" alt=""></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>Try smart defaults instead of asking to do extra work<br><img src="/images/UE29.png" alt=""></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>Try Recognition instead of recall<br><img src="/images/UE30.png" alt=""><br>Example:<br><img src="/images/UE31.png" alt=""></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>Try Inline Validation instead of delaying errors<br><img src="/images/UE32.png" alt=""><br>Example:<br><img src="/images/UE33.png" alt=""></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>Try to show error more friendly<br><img src="/images/UE34.png" alt=""><br>Example:<br><img src="/images/UE35.png" alt=""><br><img src="/images/UE36.png" alt=""></li>
</ul>
</blockquote>
<h2 id="配色优化-Color-Matching-Optimization"><a href="#配色优化-Color-Matching-Optimization" class="headerlink" title="配色优化 Color Matching Optimization"></a>配色优化 Color Matching Optimization</h2><p>配色优化旨在页面整体视觉效果的优化。大致可以归纳为3点：舒适，和谐，可区分<br>Color optimization is optimized for the overall visual effect of the page. It can be roughly summarized into three points: comfortable， harmonious, diacritical</p>
<blockquote>
<ul>
<li>根据网页主题风格配色 Color matching according to the theme of the webpage<blockquote>
<ul>
<li>黄色：乐观、年轻，常被使用在获取window shopper的注意力</li>
<li>红色：充满活力、心跳加速、创造急迫性，常出现在清仓大拍卖</li>
<li>蓝色：建立信任感和安全感，常出现在银行和企业</li>
<li>绿色：跟健康有关，对眼睛来说最舒服的颜色，通常会使用在实体店家，可传递放松的感觉</li>
<li>橘色：积极、创造行动呼吁，以带动订阅、购买或销售</li>
<li>粉红色：浪漫和女性主义，通常会女性的和年轻女性的产品市场出现</li>
<li>黑色：强而有力，通常出现在奢华的商品上</li>
<li>紫色：放松和冷静，常被用在常美妆和抗老化的产品<br><img src="/images/UE37.png" alt=""></li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>同一版面勿使用超过3种纯色，宁缺毋滥 Do not use more than 3 solid colors for the same layout</li>
<li>超链接的样式与状态的色彩搭配 The style of hyperlink status<br>(Status: normal, hover, focus, visited)<br><img src="/images/UE38.png" alt=""> -&gt; <img src="/images/UE39.png" alt=""> -&gt; <img src="/images/UE40.png" alt=""> -&gt; <img src="/images/UE41.png" alt=""></li>
<li>浅色背景搭配深色字体较易阅读 A light background with a dark font is easier to read</li>
</ul>
</blockquote>
<p>所提及的内容经本人筛选，适用于较为严肃的商业网站。</p>
<p>参考： <a href="https://goodui.org/" target="_blank" rel="noopener">goodui</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope="" itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.avrils.cc/04/14/hello-world /">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Avril Li">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/logo.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Avril的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/04/14/hello-world /" itemprop="url">
                  博客缘起 Why Blog
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-14T11:39:39+08:00">
                2018-04-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Others/" itemprop="url" rel="index">
                    <span itemprop="name">Others</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>自博客兴起之时就想着要写个自己的博客。看着人家名人发发博文，分享生活感悟，就想把自己写的那些诗文都发到博客上，也算是个念想、无奈自己是个极懒之人，也没什么耐心，估摸着自己开个博客也无心经营，遂放弃。直到大学毕业，自己入了程序猿这个坑，才把这个念想拾起。但苦于自己没什么水平，迟迟没有动手，直到现在。为什么现在想写博客了呢？写给自己。随着自己在程序猿这条路越走越远，遇到的一些问题和解决方案，总得记录下来，即使有些问题我已经心知肚明，但是也还是想把这些积累下来，帮助自己，说不定也能帮助到别人。同时，希望自己能写个中英文的博客，就当练练英文吧。至于，能不能坚持下来呢，随心吧。</p>
<p>Since the rise of the blog, I wanna build a blog of mine. Why? Cause I found that celebrities write their blog to share life and sentiment, which is funny. So that I wanna post my poems and articles on the blog. But what a pretty lazy and no patience people of me, that I thought I cannot keep manamge the blog as time gone. So, abandon. Until graduated, pick up this mind when I jump down to the developer career. Cause I known I have nothing deserve to write on the blog, haven’t do it yet. But why blog now? For myself. As my job of developer, so many problems and confuse worth to mark it, even some of them had keep in my mind. I hope these can help me, maybe some one else. At the same time, I hope that I can write a blog with Chinese and English for my English practice. As for, whether it can hold on just depends on my mood.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Console.log(<span class="string">"Welcome to Avril's Blog."</span>);</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/images/logo.png" alt="Avril Li">
          <p class="site-author-name" itemprop="name">Avril Li</p>
           
              <p class="site-description motion-element" itemprop="description">喜阅文，常笃学，善运动，乐言谈。擅长前端，偶尔研究用户体验，正致力于全栈开发。</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Avril Li</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  







  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  






  





  

  

  

  

  

</body>
</html>
